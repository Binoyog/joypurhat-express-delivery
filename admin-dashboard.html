<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

/* âœ… à¦¤à§‹à¦®à¦¾à¦° à¦†à¦¸à¦² Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyCiKuc8l-6RTZWf5FwUMEbUuMiMUUQ3lYM",
  authDomain: "joypurhat-express-delivery.firebaseapp.com",
  projectId: "joypurhat-express-delivery",
  storageBucket: "joypurhat-express-delivery.firebasestorage.app",
  messagingSenderId: "423594341774",
  appId: "1:423594341774:web:fd33f5a2d368e79e3e20df"
};

/* Init */
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* ğŸ” Admin Guard */
onAuthStateChanged(auth, (user) => {
  if (!user) location.href = "admin-login.html";
});

/* ğŸ”“ Logout */
window.logout = () => {
  signOut(auth).then(() => location.href = "admin-login.html");
};

/* â• Category */
window.addCategory = async () => {
  if (!cat.value) return alert("à¦•à§à¦¯à¦¾à¦Ÿà¦¾à¦—à¦°à¦¿ à¦²à¦¿à¦–à§à¦¨");
  await addDoc(collection(db, "categories"), { name: cat.value });
  cat.value="";
  loadData();
};

/* ğŸ“¦ Product */
window.addProduct = async () => {
  await addDoc(collection(db, "products"), {
    name: pname.value,
    category: pcat.value,
    price: price.value
  });
  alert("Product Added");
  pname.value = price.value = "";
};

/* ğŸšš Delivery */
window.addDelivery = async () => {
  await addDoc(collection(db, "orders"), {
    order: order.value,
    phone: phone.value
  });
  order.value = phone.value = "";
  loadData();
};

/* ğŸ”„ Load All Data */
async function loadData(){
  catList.innerHTML="";
  pcat.innerHTML="";
  productList.innerHTML="";
  deliveryList.innerHTML="";

  const cats = await getDocs(collection(db,"categories"));
  cats.forEach(d=>{
    catList.innerHTML+=`<div class="list">ğŸ“ ${d.data().name}</div>`;
    pcat.innerHTML+=`<option>${d.data().name}</option>`;
  });

  const prods = await getDocs(collection(db,"products"));
  prods.forEach(d=>{
    const p=d.data();
    productList.innerHTML+=`<div class="list">ğŸ“¦ ${p.name} | ${p.category} | à§³${p.price}</div>`;
  });

  const orders = await getDocs(collection(db,"orders"));
  orders.forEach(d=>{
    const o=d.data();
    deliveryList.innerHTML+=`<div class="list">ğŸšš Order: ${o.order}<br>ğŸ“ ${o.phone}</div>`;
  });
}

window.onload = loadData;
</script>

<style>
body{margin:0;font-family:Arial;background:#0f2d2f;color:#fff}
.header{padding:15px;display:flex;justify-content:space-between}
.title{color:#00ffcc;font-weight:bold}
.logout{background:red;border:none;padding:8px 15px;border-radius:10px;color:#fff}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;padding:15px}
.card{background:#27464b;padding:20px;border-radius:18px;text-align:center}
.card span{font-size:40px}
.box{background:#123c40;margin:15px;padding:15px;border-radius:15px}
input,select,button{width:100%;padding:12px;margin-top:10px;border-radius:8px;border:none}
button{background:#00e6b8;font-weight:bold}
.list{background:#1b3b40;padding:10px;border-radius:10px;margin-top:8px}
</style>
</head>

<body>

<div class="header">
  <div class="title">ğŸ›¡ï¸ ADMIN DASHBOARD</div>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="grid">
  <div class="card" onclick="categoryBox.style.display='block'"><span>â•</span><p>à¦•à§à¦¯à¦¾à¦Ÿà¦¾à¦—à¦°à¦¿</p></div>
  <div class="card" onclick="productBox.style.display='block'"><span>ğŸ“¦</span><p>à¦ªà§à¦°à§‹à¦¡à¦¾à¦•à§à¦Ÿ</p></div>
  <div class="card" onclick="deliveryBox.style.display='block'"><span>ğŸšš</span><p>à¦¡à§‡à¦²à¦¿à¦­à¦¾à¦°à¦¿</p></div>
  <div class="card" onclick="allBox.style.display='block'"><span>ğŸ“‹</span><p>à¦¸à¦¬</p></div>
</div>

<div class="box" id="categoryBox">
<h3>à¦•à§à¦¯à¦¾à¦Ÿà¦¾à¦—à¦°à¦¿ à¦¯à§‹à¦—</h3>
<input id="cat">
<button onclick="addCategory()">Add</button>
<div id="catList"></div>
</div>

<div class="box" id="productBox">
<h3>à¦ªà§à¦°à§‹à¦¡à¦¾à¦•à§à¦Ÿ à¦¯à§‹à¦—</h3>
<input id="pname">
<select id="pcat"></select>
<input id="price">
<button onclick="addProduct()">Add</button>
</div>

<div class="box" id="deliveryBox">
<h3>à¦¡à§‡à¦²à¦¿à¦­à¦¾à¦°à¦¿</h3>
<input id="order">
<input id="phone">
<button onclick="addDelivery()">Save</button>
<div id="deliveryList"></div>
</div>

<div class="box" id="allBox">
<h3>à¦¸à¦¬ à¦ªà§à¦°à§‹à¦¡à¦¾à¦•à§à¦Ÿ</h3>
<div id="productList"></div>
</div>

</body>
</html>
